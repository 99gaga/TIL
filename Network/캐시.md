# 캐시

### 캐시(Cache)란?

---

#### [캐시]

`자주 사용하는 데이터를 미리 복사해 놓는 임시 장소`를 가리킨다. 캐시는 저장공간이 작고 비싸지만 빠른 응답 속도를 제공해준다. <br>
<br>

![cache](../image/cache.png)

캐시에 반복되는 계산의 결과나 데이터를 복사해 놓는다면 계산과정이나 이미지 같은 데이터를 시간이 비교적 오래걸리는 DBMS에 요청하지 않고 캐시에서 가져와 보다 빠른 응답을 할 수 있게 해준다. 그래서 결과적으로 DBMS의 부하를 줄이고 캐시를 이용해 애플리케이션의 성능을 높일 수 있다. `Long Tail` 법칙에 의하면 사용자들은 전체 시스템에서 20%의 자원만을 자주 요청하여 쓰이게 된다고 한다. 데이터 베이스와는 대조적으로 영구적으로 저장해야할 데이터는 부적합하다. 이런 부분에 캐시를 이용한다면 성능을 향상 시킬 수 있다. <br>
<br>
CPU 칩에는 여러 개의 캐시가 들어가며 각각의 캐시는 목적과 역할이 있다. <br>

- L1 Cache: 프로세서와 가장 가까운 캐시. 속도를 위해 I$와 D$로 나뉜다.
  - Instruction Cache (I$): 메모리의 TEXT 영역 데이터를 다루는 캐시
  - Data Cache (D$): TEXT 영역을 제외한 모든 데이터를 다루는 캐시
- L2 Cache: 용량이 큰 캐시. 크기를 위해 L1 캐시처럼 나누지 않는다
- L3 Cache: 멀티 코어 시스템에서 여러 코어가 공유하는 캐시

#### [자주 사용하는 데이터란?]

지역성의 따라서 시간 지역성과 공간 지역성으로 구분해서 볼 수 있다. <br>
시간 지역성을 최근 접근한 데이터에 다시 접근하는 경향을 말한다. 공간 지역성은 최근 접근한 데이터의 주변 공간에 접근할 확률이 높다는 경향을 말한다.
![지역성](../image/지역성.png)
한 프로세스 안에도 자주 사용하는 부분과 아닌 부분이 있기에 OS는 페이지 단위로 관리를 한다. 이처럼 페이지를 접근할 때에도 지역성의 원리가 적용된다. <br>
<br>

#### [언제 사용하나?]

- 데이터의 접근 시간이 오래 걸리는 경우 <br>
- 이미지와 같이 정적인 데이터의 접근 <br>
- 업데이트가 자주 발생하지 않는 데이터 <br>
  <br>

#### [캐시 히트와 캐시 미스]

캐시에서 데이터를 찾을 경우 캐시 히트라고 한다. 히트 레이턴시는 히트가 발생해 요청이 소요되는 시간을 말한다. 반면 캐시에 찾는 데이터가 없을 경우 캐시 미스라고 하며, 미스 레이턴시는 캐시 미스로 인해 요청에 대해 소요되는 시간을 말한다. 캐시의 성능을 높이기 위해서 캐시의 크기를 줄여 히트 레이턴시를 줄이거나, 캐시의 크기를 늘려 미스 비율을 줄이거나, 더 빠른 캐시를 사용하는 방법이 있다.<br>
<br>

#### [Local Cache vs Global Cache]

##### Local Cache

- 서버마다 캐시를 따로 저장 <br>
- 다른 서버와 캐시에 저장된 데이터를 공유하기 어렵다. <br>
- 서버 내 캐시를 이용하기 때문에 속도가 빠르다. <br>
- 로컬 서버의 리소스를 이용한다. <br>

##### Global Cache

- 캐시서버를 따로 두어 여러 서버에서 참조하여 이용한다. <br>
- 대신 네트워크를 이용하기 때문에 `Local Cache`보다는 느리다. <br>
- 별도의 캐시 서버를 이용하기 때문에 서버간 데이터 공유가 쉽다. <br>
  `
